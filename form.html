<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>XAU Layering – Input</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .fade-in { animation: fade .35s ease both; }
    @keyframes fade { from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:none} }
  </style>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center p-6 text-gray-900">
  <main class="w-full max-w-xl bg-white shadow-lg rounded-2xl p-8 fade-in">
    <header class="text-center space-y-2 mb-6">
      <h1 class="text-3xl font-bold tracking-tight">XAU Layering Simulator</h1>
      <p class="text-gray-500 text-sm">
        Masukkan parameter sesuai contoh.
      </p>
    </header>

    <section class="space-y-5">
      <label class="block">
        <span class="text-sm font-medium">Modal (USC)</span>
        <input id="modal" type="number" inputmode="numeric" placeholder="contoh: 70000"
               class="mt-1 w-full border rounded-xl p-3 text-lg focus:ring-2 focus:ring-blue-500 outline-none">
        <small class="text-xs text-gray-500">Total dana yang dipakai.</small>
      </label>

      <label class="block">
        <span class="text-sm font-medium">Lot per Layer</span>
        <input id="lot" type="number" step="0.01" placeholder="contoh: 0.03"
               class="mt-1 w-full border rounded-xl p-3 text-lg focus:ring-2 focus:ring-blue-500 outline-none">
        <small class="text-xs text-gray-500">Ukuran posisi tiap layer.</small>
      </label>

      <label class="block">
        <span class="text-sm font-medium">Harga Entry</span>
        <input id="price" type="number" placeholder="contoh: 3700"
               class="mt-1 w-full border rounded-xl p-3 text-lg focus:ring-2 focus:ring-blue-500 outline-none">
        <small class="text-xs text-gray-500">Harga entry saat mulai layering.</small>
      </label>

      <label class="block">
        <span class="text-sm font-medium">Spacing awal</span>
        <input id="s1" type="number" step="0.1" placeholder="contoh: 2"
               class="mt-1 w-full border rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none">
        <small class="text-xs text-gray-500">Jarak antar layer untuk Tahap 1.</small>
      </label>
    </section>

    <div id="error" class="hidden mt-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-xl p-3"></div>

    <div class="mt-6 flex flex-col sm:flex-row items-center gap-3">
      <button id="run" class="flex-1 px-6 py-3 text-lg rounded-xl bg-blue-600 text-white shadow hover:bg-blue-700">
        Run Simulation
      </button>
      <button id="reset" class="px-4 py-3 rounded-xl border hover:bg-gray-50">
        Reset
      </button>
    </div>

   <!-- <footer class="mt-4 text-xs text-gray-400 text-center"> 
     Tip: isikan angka lalu tekan <b>Enter</b> untuk cepat menjalankan simulasi.
   </footer> -->
  </main>

  <script>
    const $ = id => document.getElementById(id);

    // Load last inputs (localStorage)
    (function loadDraft(){
      try{
        const d = JSON.parse(localStorage.getItem('xau_form_draft')||'{}');
        if(d.modal) $('modal').value = d.modal;
        if(d.lot)   $('lot').value   = d.lot;
        if(d.price) $('price').value = d.price;
        if(d.s1)    $('s1').value    = d.s1;
      }catch{}
    })();

    // Save on change (debounced)
    ['modal','lot','price','s1'].forEach(id=>{
      $(id).addEventListener('input', debounce(saveDraft, 250));
    });
    function saveDraft(){
      const draft = {
        modal: $('modal').value,
        lot:   $('lot').value,
        price: $('price').value,
        s1:    $('s1').value
      };
      localStorage.setItem('xau_form_draft', JSON.stringify(draft));
    }
    function debounce(fn,ms){
      let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), ms); };
    }

    // Submit
    function submit(){
      const modal = $('modal').value.trim();
      const lot   = $('lot').value.trim();
      const price = $('price').value.trim();
      const s1    = $('s1').value.trim() || '2';

      const err = $('error'); err.classList.add('hidden'); err.textContent = '';
      const problems = [];
      if(!modal || +modal<=0) problems.push('Modal harus diisi (> 0).');
      if(!lot   || +lot<=0)   problems.push('Lot per layer harus diisi (> 0).');
      if(!price || +price<=0) problems.push('Harga awal harus diisi (> 0).');

      if(problems.length){
        err.innerHTML = problems.map(x=>`• ${x}`).join('<br>');
        err.classList.remove('hidden');
        return;
      }

      const q = new URLSearchParams({ modal, lot, price, s1 });
      location.href = `result.html?${q.toString()}`;
    }

    $('run').addEventListener('click', submit);
    $('reset').addEventListener('click', ()=>{
      ['modal','lot','price','s1'].forEach(id=>$(id).value='');
      localStorage.removeItem('xau_form_draft');
      $('error').classList.add('hidden');
    });

    // Enter to submit
    document.addEventListener('keydown', (e)=>{
      if(e.key==='Enter') submit();
    });
  </script>
</body>
</html>
